<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ä¸ªäººHibernate (Spring Data JPA) å…¥é—¨æ•´ç†"><title>Hibernateå…¥é—¨ç¯‡ - ORMçœŸé¦™</title>
<link rel=canonical href=https://c-poet.github.io/post/framework/spring/hibernate-orm-basic/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Hibernateå…¥é—¨ç¯‡ - ORMçœŸé¦™"><meta property='og:description' content="ä¸ªäººHibernate (Spring Data JPA) å…¥é—¨æ•´ç†"><meta property='og:url' content='https://c-poet.github.io/post/framework/spring/hibernate-orm-basic/'><meta property='og:site_name' content='CPoet'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Spring'><meta property='article:tag' content='Hibernate'><meta property='article:tag' content='Spring-Data-Jpa'><meta property='article:published_time' content='2020-10-06T22:50:48+08:00'><meta property='article:modified_time' content='2020-10-06T22:50:48+08:00'><meta name=twitter:title content="Hibernateå…¥é—¨ç¯‡ - ORMçœŸé¦™"><meta name=twitter:description content="ä¸ªäººHibernate (Spring Data JPA) å…¥é—¨æ•´ç†"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hub69c133b9baecf73314fbafde4b0bf83_88883_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ§‘â€ğŸ’»</span></figure><div class=site-meta><h1 class=site-name><a href=/>CPoet</a></h1><h2 class=site-description>å¿ƒä¸­è‹¥æ— æ¢¦ï¼Œåˆä½•ä»¥è‡´è¿œã€‚</h2></div></header><ol class=menu-social><li><a href=https://blog.csdn.net/qq_42304721 target=_blank title=CSDN rel=me><!doctype html><svg t="1719657462265" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="5267" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M530.9293681 431.99298667c12.69089853-1.39850077 32.17241993-2.81598184 58.96997255-2.81598184 44.75202505.0 80.92755642 7.8957922 103.33549032 24.51560657 20.13547797 15.48790009 33.52519552 40.55565997 29.81627827 76.89597458-3.43197786 33.81076231-20.74198383 57.48864879-45.99437 72.12071127-23.0981255099999 13.81332266-52.17848695 19.72136298-95.94526346 19.72136298-25.78555916.0-50.402969-1.41748106-69.11147578-4.22397275l18.9293681-186.21370082zm36.98564379 149.2013121c4.29730562.85583762 9.97499448 1.70218509 21.16558896 1.7021851 44.76151521.0 76.3265665-22.32511089 79.51007536-53.69690853 4.60098993-45.34127616-23.40180983-61.20619343-70.57468202-60.93011679-6.10129397.0-14.59496468.0-19.09501409.83685734L567.90552174 581.20378891h.0086274zm192.82056016-142.09665206c181.99921821-34.39915066 197.70797962 27.4144114 192.08550608 82.12331343L942.21024461 622.43066023H884.4550093l9.67131017-92.30191443c2.08955515-20.32786888 15.10225553-60.09239669-47.74228028-58.59209265-21.7272324.52454563-32.53131957 3.50617346-32.53131957 3.50617347s-1.88594862 24.56133176-4.16875743 42.71768524L798.70560163 622.43066023h-56.64143855l11.23631967-103.16035419" fill="#231916" p-id="5268"/><path d="M265.80433314 616.11799508c-10.67553898 3.74515232-32.81688637 6.31266516-63.76507889 6.31266515C113.06923991 622.43066023 65.05951037 580.09861956 70.72857184 524.15600002c6.80960313-66.67251112 77.93643846-104.18183779 155.82628898-104.18183779 30.17517791.0 47.92690654 2.46657234 64.58381871 6.58960456l-5.35588702 44.91767104c-11.06118355-3.78225011-37.00289858-7.25218852-58.00370429-7.25218852-45.84684153.0-84.76415912 13.84093033-89.22797347 57.59907945-3.97550376 39.12955153 23.3465945 57.8380583 74.89959531 57.8380583 17.94498229.0 44.41124294-2.60461066 56.64143856-6.35839035l-4.30679575 42.79188083.01898028.01725479z" fill="#c92027" p-id="5269"/><path d="M305.55937083 570.68440578c16.63793189 5.83470746 51.32264935 11.65043465 79.37203705 11.65043465 30.2209031.0 47.04346126-8.05194806 48.39623685-20.53061266 1.22336465-11.39247553-11.15349668-12.92987738-45.28606084-20.71437619-47.16338205-11.12675175-77.25573697-28.3349545-74.3103442-55.82356149C317.17270769 453.32508436 361.6115583 429.17700483 429.80249098 429.17700483c33.26723639.0 65.49487164 2.25433839 82.19750902 7.51877503l-5.74239433 40.26060304c-10.84032224-3.62523151-52.34413295-8.65931669-80.41163819-8.65931669-28.46350268.0-43.19736842 8.60410136-44.21885202 18.04592281-1.28807011 11.94549158 13.50963835 12.49764488 50.49441939 21.95758387 50.06218689 12.2120781 71.95506527 29.41079069 69.09335825 56.07116773C497.85538535 595.77977332 457.87085896 622.43066023 378.02949161 622.43066023c-33.23962873.0-61.89638506-5.83470746-77.68796948-11.66855218l5.21784869-40.07770228z" fill="#231916" p-id="5270"/></svg></a></li><li><a href=https://github.com/c-poet target=_blank title=GitHub rel=me><!doctype html><svg t="1719658035343" class="icon" viewBox="0 0 3786 1024" xmlns="http://www.w3.org/2000/svg" p-id="19106" xmlns:xlink="http://www.w3.org/1999/xlink" width="739.453125" height="200"><path d="M729.176289 438.294072H410.703618c-7.882987.0-14.977675 6.30639-14.977675 14.977675V608.56659c0 7.882987 6.30639 14.977675 14.977675 14.977675h123.762895v193.133179s-27.590454 9.459584-104.843726 9.459584c-90.654349.0-217.570439-33.108545-217.570439-312.166281s132.43418-316.107775 256.197075-316.107775c107.208622.0 153.718245 18.919169 182.885296 28.378752 9.459584 3.153195 18.13087-6.30639 18.13087-14.977675l35.473441-150.56505c0-3.941493-1.576597-8.671286-5.518091-11.82448C687.396459 40.991532 614.872979.0 430.411085.0 217.570439.0.0 90.654349.0 525.006928S249.102386 1024 459.578137 1024c174.214011.0 279.846035-74.100077 279.846035-74.100077 4.729792-2.364896 4.729792-8.671286 4.729793-11.036182V453.271747c0-8.671286-7.094688-14.977675-14.977676-14.977675zM2368.837567 52.027714c0-7.882987-6.30639-14.977675-14.977675-14.977676h-178.943803c-7.882987.0-14.977675 6.30639-14.977675 14.977676v346.063125h-279.057737V52.027714c0-7.882987-6.30639-14.977675-14.977675-14.977676H1686.959199c-7.882987.0-14.977675 6.30639-14.977675 14.977676v937.287144c0 7.882987 6.30639 14.977675 14.977675 14.977675h178.943803c7.882987.0 14.977675-7.094688 14.977675-14.977675V588.070824h279.057737l-.788299 401.244034c0 7.882987 6.30639 14.977675 14.977676 14.977675h179.732101c7.882987.0 14.977675-7.094688 14.977675-14.977675V52.027714z" fill="#100e0f" p-id="19107"/><path d="M1067.356428 175.002309c0-64.640493-52.027714-116.668206-115.879908-116.668206s-115.091609 52.027714-115.091609 116.668206c0 64.640493 52.027714 116.668206 115.091609 116.668207 63.852194.0 115.879908-52.027714 115.879908-116.668207zm-12.612779 616.449577V358.675905c0-7.882987-6.30639-14.977675-14.977675-14.977676H860.822171c-7.882987.0-15.765974 8.671286-15.765974 16.554273v619.602771c0 18.13087 11.036182 23.648961 26.013857 23.648961h160.812933c17.342571.0 22.072363-8.671286 22.072363-23.648961.788299-33.108545.788299-163.177829.788299-188.403387z" fill="#100e0f" p-id="19108"/><path d="M3049.139338 345.274827h-177.367206c-7.882987.0-14.977675 7.094688-14.977675 14.977675V819.830639s-44.933025 33.108545-109.573518 33.108545c-63.852194.0-81.194765-29.167052-81.194765-92.230947V360.252502c0-7.882987-6.30639-14.977675-14.977675-14.977675h-180.5204c-7.882987.0-14.977675 7.094688-14.977676 14.977675v431.199384c0 186.038491 104.055427 231.759815 246.737491 231.759815 117.456505.0 212.052348-64.640493 212.052348-64.640492s4.729792 33.896844 6.306389 37.838337c2.364896 3.941493 7.094688 7.882987 13.401078 7.882987l115.091609-.788299c7.882987.0 14.977675-7.094688 14.977675-14.977675V359.464203c0-7.094688-6.30639-14.189376-14.977675-14.189376zm486.380292-20.495766c-100.902232.0-169.484219 44.933025-169.484218 44.933025V52.027714c0-7.882987-6.30639-14.977675-14.977675-14.977676h-179.732102c-7.882987.0-14.977675 6.30639-14.977675 14.977676v937.287144c0 7.882987 6.30639 14.977675 14.977675 14.977675h124.551193c5.518091.0 10.247883-3.153195 12.612779-7.882987 3.153195-4.729792 7.882987-43.356428 7.882987-43.356428s73.311778 69.370285 212.840647 69.370285c163.177829.0 256.985373-82.771363 256.985373-372.076983-.788299-288.517321-149.776751-325.56736-250.678984-325.567359zm-70.158583 527.371824c-61.487298-1.576597-103.267129-29.95535-103.267129-29.95535V525.795227s40.991532-25.225558 92.230947-29.95535c63.852194-5.518091 125.339492 13.401078 125.339492 166.331024-.788299 160.812933-28.378753 193.133179-114.30331 189.979984zM1569.502694 343.698229h-134.010777V166.331024c0-7.094688-3.153195-10.247883-11.036182-10.247883h-182.885296c-7.094688.0-11.036182 3.153195-11.036182 10.247883v183.673595s-91.442648 22.072363-97.749038 23.648961c-6.30639 1.576597-11.036182 7.882987-11.036181 14.189376v115.091609c0 8.671286 6.30639 14.977675 14.977675 14.977675h93.807544v277.48114c0 205.745958 144.258661 226.241724 242.007698 226.241724 44.933025.0 97.749038-14.189376 106.420324-17.342571 5.518091-1.576597 8.671286-7.094688 8.671285-13.401078V863.975366c0-7.882987-7.094688-14.977675-14.977675-14.977675-7.882987.0-27.590454 3.153195-48.874519 3.153194-66.21709.0-88.289453-30.743649-88.289453-70.158583V518.700539h134.010777c7.882987.0 14.977675-6.30639 14.977676-14.977675V358.675905c-.788299-7.882987-7.094688-14.977675-14.977676-14.977676z" fill="#100e0f" p-id="19109"/></svg></a></li><li><a href=https://www.cnblogs.com/cpoet target=_blank title=åšå®¢å›­ rel=me><!doctype html><svg t="1719667888485" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="3218" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M478.71488 33.88416c-75.76064 36.6592-123.11552 117.31456-114.82624 194.82624 8.28416 67.03616 43.8016 120.45824 104.17152 156.06784C655.09888 494.76096 887.1168 305.17248 784.128 126.05952 722.57536 20.26496 591.17568-19.53792 478.71488 33.88416zm187.03872 67.03616c85.23264 52.37248 80.49664 188.53888-9.472 229.39136-104.17152 48.18432-213.07904-15.71328-213.07904-125.696.0-41.89696 5.91872-54.46656 40.24832-84.84352s48.5376-35.61472 98.2528-35.61472c33.14688.00512 68.6592 7.33696 84.04992 16.76288z" fill="#333" p-id="3219"/><path d="M797.15328 340.7872c-63.9232 115.22048-89.96864 148.736-164.54656 217.87136-75.76064 71.22432-105.35424 90.08128-209.53088 135.12192-67.47648 29.32736-132.5824 50.2784-147.97312 48.18432-22.49216-2.09408-36.69504-25.1392-88.78592-139.31008C120.02816 458.10176 53.73952 333.45536 25.32864 298.89024 8.7552 278.9888 7.57248 280.0384 13.4912 309.36576 40.71424 465.4336 133.05344 774.43072 161.46432 803.75808c15.39072 17.80736 295.94624 18.85184 456.93952 2.09408 190.58688-19.90144 170.46528-27.23328-121.92768-47.13472l-106.54208-7.33184 102.9888-24.0896c114.82624-27.23328 177.56672-52.37248 261.61664-105.79456C786.50368 601.6 817.28 586.93632 824.38144 589.0304c5.91872 2.09408 49.72032 98.46272 94.70464 212.6336 46.16704 115.22048 86.41536 212.6336 91.15136 216.82176 11.83744 11.52-8.28416-233.57952-28.41088-358.22592-10.65472-60.75392-39.0656-187.4944-63.9232-282.81344l-44.98432-172.83072-75.76576 136.17152z" fill="#333" p-id="3220"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>é¦–é¡µ</span></a></li><li><a href=/page/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>åˆ†ç±»</span></a></li><li><a href=/page/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=/page/projects/><!doctype html><svg t="1719657607322" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="13066" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M98.3 540.2l2.3 2.1 345.3 189.1c17.6 14.7 40.5 22.8 64.6 22.8s47-8.1 64.6-22.8l344.8-188.8.5-.3 2.3-2.1c34.8-31.3 39-82 9.8-118-1.7-2.1-4.9-2.5-7-.7l-33.7 27.4c-2.1 1.7-2.5 4.9-.7 7 10.6 13 9.7 30.5-2.1 42.7L544.7 687.1l-.5.3-2.3 2.1c-17 15.3-45.8 15.3-62.8.0l-2.3-2.1-344.7-188.8c-11.8-12.2-12.7-29.7-2.1-42.7 1.7-2.1 1.4-5.3-.7-7l-33.7-27.4c-2.1-1.7-5.3-1.4-7 .7-29.4 35.9-25.1 86.7 9.7 118z" fill="#424242" p-id="13067"/><path d="M925.5 608.3l-33.7 27.4c-2.1 1.7-2.5 4.9-.7 7 10.6 13 9.7 30.5-2.1 42.7L544.7 873.9l-.5.3-2.3 2.1c-17 15.3-45.8 15.3-62.8.0l-2.3-2.1-344.7-188.8c-11.8-12.2-12.7-29.7-2.1-42.7 1.7-2.1 1.4-5.3-.7-7l-33.7-27.4c-2.1-1.7-5.3-1.4-7 .7-29.2 35.9-25 86.7 9.8 118l2.3 2.1L446 918.2c17.6 14.7 40.5 22.8 64.6 22.8s47-8.1 64.6-22.8L920 729.4l.5-.3 2.3-2.1c34.8-31.3 39-82 9.8-118-1.8-2.1-4.9-2.5-7.1-.7zM116.1 372.6l54.5 29.8 290.6 159.1c27.2 24.5 71.4 24.5 98.6.0l290.6-159.1 54.5-29.8c2.6-2.3 4.9-4.8 7-7.4 19.9-24.5 17.7-59.1-7-81.3L559.8 99.3c-27.2-24.5-71.4-24.5-98.6.0L116.1 283.9c-24.6 22.2-26.9 56.7-7 81.3 2.2 2.6 4.4 5.1 7 7.4z" fill="#424242" p-id="13068"/></svg>
<span>é¡¹ç›®</span></a></li><li><a href=/page/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#hibernateæ¶æ„>Hibernateæ¶æ„</a><ol><li><a href=#é…ç½®å¯¹è±¡>é…ç½®å¯¹è±¡</a></li><li><a href=#sessionfactoryå¯¹è±¡>SessionFactoryå¯¹è±¡</a></li><li><a href=#sessionå¯¹è±¡>Sessionå¯¹è±¡</a></li><li><a href=#transactionå¯¹è±¡>Transactionå¯¹è±¡</a></li><li><a href=#queryå¯¹è±¡>Queryå¯¹è±¡</a></li><li><a href=#criteria>Criteria</a></li></ol></li><li><a href=#å¼•å…¥hibernate>å¼•å…¥Hibernate</a><ol><li><a href=#æ‰‹åŠ¨å¼•å…¥>æ‰‹åŠ¨å¼•å…¥</a></li><li><a href=#maven>maven</a></li></ol></li><li><a href=#hibernatecfgxmlé…ç½®æ–‡ä»¶>hibernate.cfg.xmlé…ç½®æ–‡ä»¶</a><ol><li><a href=#å‡ ä¸ªé‡è¦çš„é…ç½®å±æ€§>å‡ ä¸ªé‡è¦çš„é…ç½®å±æ€§</a></li><li><a href=#æ•°æ®åº“æ–¹è¨€>æ•°æ®åº“æ–¹è¨€</a></li></ol></li><li><a href=#ç®€å•çš„xmlæ˜ å°„æ–‡ä»¶>ç®€å•çš„XMLæ˜ å°„æ–‡ä»¶</a><ol><li><a href=#hibernate-typeé¢„è®¾å€¼>hibernate typeé¢„è®¾å€¼</a><ol><li><a href=#åŸå§‹ç±»å‹>åŸå§‹ç±»å‹</a></li><li><a href=#æ—¥æœŸå’Œæ—¶é—´ç±»å‹>æ—¥æœŸå’Œæ—¶é—´ç±»å‹</a></li><li><a href=#äºŒè¿›åˆ¶å’Œå¤§å‹æ•°æ®ç±»å‹>äºŒè¿›åˆ¶å’Œå¤§å‹æ•°æ®ç±»å‹</a></li><li><a href=#jdkç›¸å…³ç±»å‹>JDKç›¸å…³ç±»å‹</a></li></ol></li></ol></li><li><a href=#æ˜ å°„æ³¨è§£>æ˜ å°„æ³¨è§£</a><ol><li><ol><li><a href=#entity>@Entity</a></li><li><a href=#table>@Table</a></li><li><a href=#id>@Id</a></li><li><a href=#generatedvalue>@GeneratedValue</a></li><li><a href=#column>@Column</a></li><li><a href=#dynamicupdateå’Œdynamicinsert>@DynamicUpdateå’Œ@DynamicInsert</a></li><li><a href=#å®ä½“å…³ç³»è¡¨é—´å…³ç³»>å®ä½“å…³ç³»ï¼ˆè¡¨é—´å…³ç³»ï¼‰</a></li></ol></li></ol></li><li><a href=#åˆ›å»ºä¼šè¯session>åˆ›å»ºä¼šè¯ï¼ˆSessionï¼‰</a><ol><li><a href=#sessionfactory>SessionFactory</a></li><li><a href=#æ‰“å¼€ä¼šè¯>æ‰“å¼€ä¼šè¯</a></li></ol></li><li><a href=#hql-hibernate-query-language>HQL (hibernate query language)</a><ol><li><a href=#selectè¯­å¥>SELECTè¯­å¥</a></li><li><a href=#åŠ¨æ€å‚æ•°>åŠ¨æ€å‚æ•°</a></li><li><a href=#deleteè¯­å¥>DELETEè¯­å¥</a></li><li><a href=#updateè¯­å¥>UPDATEè¯­å¥</a></li><li><a href=#insertè¯­å¥>INSERTè¯­å¥</a></li><li><a href=#where-å­å¥>WHERE å­å¥</a></li><li><a href=#aså…³é”®å­—>ASå…³é”®å­—</a></li><li><a href=#order-by-æ’åº>ORDER BY æ’åº</a></li><li><a href=#group-by-åˆ†ç»„>GROUP BY åˆ†ç»„</a></li><li><a href=#åˆ†é¡µæŸ¥è¯¢>åˆ†é¡µæŸ¥è¯¢</a></li><li><a href=#èšåˆå‡½æ•°>èšåˆå‡½æ•°</a></li></ol></li><li><a href=#æ ‡å‡†æŸ¥è¯¢>æ ‡å‡†æŸ¥è¯¢</a></li><li><a href=#åŸç”ŸæŸ¥è¯¢>åŸç”ŸæŸ¥è¯¢</a></li><li><a href=#interceptor-æ‹¦æˆªå™¨>interceptor æ‹¦æˆªå™¨</a><ol><li><a href=#æ‹¦æˆªå™¨å¸¸ç”¨æ–¹æ³•è§£é‡Š>æ‹¦æˆªå™¨å¸¸ç”¨æ–¹æ³•è§£é‡Š</a></li><li><a href=#ä½¿ç”¨è‡ªå®šä¹‰æ‹¦æˆªå™¨>ä½¿ç”¨è‡ªå®šä¹‰æ‹¦æˆªå™¨</a></li></ol></li><li><a href=#hibernateç¼“å­˜>hibernateç¼“å­˜</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/framework/spring/ style=background-color:#6eb141;color:#fff>Spring å…¨å®¶æ¡¶</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/framework/spring/hibernate-orm-basic/>Hibernateå…¥é—¨ç¯‡ - ORMçœŸé¦™</a></h2><h3 class=article-subtitle>ä¸ªäººHibernate (Spring Data JPA) å…¥é—¨æ•´ç†</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2020-10-06 22:50</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 13 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h2 id=hibernateæ¶æ„>Hibernateæ¶æ„</h2><p>Hibernateæ¶æ„å›¾ï¼š</p><p><img src=/post/framework/spring/hibernate-orm-basic/20201006230334202.jpg width=460 height=374 srcset="/post/framework/spring/hibernate-orm-basic/20201006230334202_hu8346dbe188769a6c1ad1d211deed9768_27580_480x0_resize_q75_box.jpg 480w, /post/framework/spring/hibernate-orm-basic/20201006230334202_hu8346dbe188769a6c1ad1d211deed9768_27580_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=122 data-flex-basis=295px></p><p>Hibernate ä½¿ç”¨ä¸åŒçš„ç°å­˜ Java APIï¼Œæ¯”å¦‚ JDBCï¼ŒJava äº‹åŠ¡ APIï¼ˆJTAï¼‰ï¼Œä»¥åŠ Java å‘½åå’Œç›®å½•ç•Œé¢ï¼ˆJNDIï¼‰ã€‚JDBC æä¾›äº†ä¸€ä¸ªåŸºæœ¬çš„æŠ½è±¡çº§åˆ«çš„é€šç”¨å…³ç³»æ•°æ®åº“çš„åŠŸèƒ½ï¼Œ Hibernate æ”¯æŒå‡ ä¹æ‰€æœ‰å¸¦æœ‰ JDBC é©±åŠ¨çš„æ•°æ®åº“ã€‚JNDI å’Œ JTA å…è®¸ Hibernate ä¸ J2EE åº”ç”¨ç¨‹åºæœåŠ¡å™¨ç›¸é›†æˆã€‚</p><h3 id=é…ç½®å¯¹è±¡>é…ç½®å¯¹è±¡</h3><p>é…ç½®å¯¹è±¡æ˜¯ä½ åœ¨ä»»ä½• Hibernate åº”ç”¨ç¨‹åºä¸­åˆ›é€ çš„ç¬¬ä¸€ä¸ª Hibernate å¯¹è±¡ï¼Œå¹¶ä¸”ç»å¸¸åªåœ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–æœŸé—´åˆ›é€ ã€‚å®ƒä»£è¡¨äº† Hibernate æ‰€éœ€ä¸€ä¸ªé…ç½®æˆ–å±æ€§æ–‡ä»¶ã€‚é…ç½®å¯¹è±¡æä¾›äº†ä¸¤ç§åŸºç¡€ç»„ä»¶ã€‚</p><ul><li><strong>æ•°æ®åº“è¿æ¥</strong>ï¼šç”± Hibernate æ”¯æŒçš„ä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®æ–‡ä»¶å¤„ç†ã€‚è¿™äº›æ–‡ä»¶æ˜¯ <strong>hibernate.properties</strong> å’Œ <strong>hibernate.cfg.xml</strong>ã€‚</li><li><strong>ç±»æ˜ å°„è®¾ç½®</strong>ï¼šè¿™ä¸ªç»„ä»¶åˆ›é€ äº† Java ç±»å’Œæ•°æ®åº“è¡¨æ ¼ä¹‹é—´çš„è”ç³»ã€‚</li></ul><h3 id=sessionfactoryå¯¹è±¡>SessionFactoryå¯¹è±¡</h3><p>é…ç½®å¯¹è±¡æ˜¯ä½ åœ¨ä»»ä½• Hibernate åº”ç”¨ç¨‹åºä¸­åˆ›é€ çš„ç¬¬ä¸€ä¸ª Hibernate å¯¹è±¡ï¼Œå¹¶ä¸”ç»å¸¸åªåœ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–æœŸé—´åˆ›é€ ã€‚å®ƒä»£è¡¨äº† Hibernate æ‰€éœ€ä¸€ä¸ªé…ç½®æˆ–å±æ€§æ–‡ä»¶ã€‚é…ç½®å¯¹è±¡æä¾›äº†ä¸¤ç§åŸºç¡€ç»„ä»¶ã€‚</p><ul><li><strong>æ•°æ®åº“è¿æ¥</strong>ï¼šç”± Hibernate æ”¯æŒçš„ä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®æ–‡ä»¶å¤„ç†ã€‚è¿™äº›æ–‡ä»¶æ˜¯ <strong>hibernate.properties</strong> å’Œ <strong>hibernate.cfg.xml</strong>ã€‚</li><li><strong>ç±»æ˜ å°„è®¾ç½®</strong>ï¼šè¿™ä¸ªç»„ä»¶åˆ›é€ äº† Java ç±»å’Œæ•°æ®åº“è¡¨æ ¼ä¹‹é—´çš„è”ç³»ã€‚</li></ul><h3 id=sessionå¯¹è±¡>Sessionå¯¹è±¡</h3><p>é…ç½®å¯¹è±¡æ˜¯ä½ åœ¨ä»»ä½• Hibernate åº”ç”¨ç¨‹åºä¸­åˆ›é€ çš„ç¬¬ä¸€ä¸ª Hibernate å¯¹è±¡ï¼Œå¹¶ä¸”ç»å¸¸åªåœ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–æœŸé—´åˆ›é€ ã€‚å®ƒä»£è¡¨äº† Hibernate æ‰€éœ€ä¸€ä¸ªé…ç½®æˆ–å±æ€§æ–‡ä»¶ã€‚é…ç½®å¯¹è±¡æä¾›äº†ä¸¤ç§åŸºç¡€ç»„ä»¶ã€‚</p><ul><li><strong>æ•°æ®åº“è¿æ¥</strong>ï¼šç”± Hibernate æ”¯æŒçš„ä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®æ–‡ä»¶å¤„ç†ã€‚è¿™äº›æ–‡ä»¶æ˜¯ <strong>hibernate.properties</strong> å’Œ <strong>hibernate.cfg.xml</strong>ã€‚</li><li><strong>ç±»æ˜ å°„è®¾ç½®</strong>ï¼šè¿™ä¸ªç»„ä»¶åˆ›é€ äº† Java ç±»å’Œæ•°æ®åº“è¡¨æ ¼ä¹‹é—´çš„è”ç³»ã€‚</li></ul><h3 id=transactionå¯¹è±¡>Transactionå¯¹è±¡</h3><p>é…ç½®å¯¹è±¡æ˜¯ä½ åœ¨ä»»ä½• Hibernate åº”ç”¨ç¨‹åºä¸­åˆ›é€ çš„ç¬¬ä¸€ä¸ª Hibernate å¯¹è±¡ï¼Œå¹¶ä¸”ç»å¸¸åªåœ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–æœŸé—´åˆ›é€ ã€‚å®ƒä»£è¡¨äº† Hibernate æ‰€éœ€ä¸€ä¸ªé…ç½®æˆ–å±æ€§æ–‡ä»¶ã€‚é…ç½®å¯¹è±¡æä¾›äº†ä¸¤ç§åŸºç¡€ç»„ä»¶ã€‚</p><ul><li><strong>æ•°æ®åº“è¿æ¥</strong>ï¼šç”± Hibernate æ”¯æŒçš„ä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®æ–‡ä»¶å¤„ç†ã€‚è¿™äº›æ–‡ä»¶æ˜¯ <strong>hibernate.properties</strong> å’Œ <strong>hibernate.cfg.xml</strong>ã€‚</li><li><strong>ç±»æ˜ å°„è®¾ç½®</strong>ï¼šè¿™ä¸ªç»„ä»¶åˆ›é€ äº† Java ç±»å’Œæ•°æ®åº“è¡¨æ ¼ä¹‹é—´çš„è”ç³»ã€‚</li></ul><h3 id=queryå¯¹è±¡>Queryå¯¹è±¡</h3><p>Query å¯¹è±¡ä½¿ç”¨ SQL æˆ–è€… Hibernate æŸ¥è¯¢è¯­è¨€ï¼ˆHQLï¼‰å­—ç¬¦ä¸²åœ¨æ•°æ®åº“ä¸­æ¥æ£€ç´¢æ•°æ®å¹¶åˆ›é€ å¯¹è±¡ã€‚ä¸€ä¸ªæŸ¥è¯¢çš„å®ä¾‹è¢«ç”¨äºè¿ç»“æŸ¥è¯¢å‚æ•°ï¼Œé™åˆ¶ç”±æŸ¥è¯¢è¿”å›çš„ç»“æœæ•°é‡ï¼Œå¹¶æœ€ç»ˆæ‰§è¡ŒæŸ¥è¯¢ã€‚</p><h3 id=criteria>Criteria</h3><p>Criteria å¯¹è±¡è¢«ç”¨äºåˆ›é€ å’Œæ‰§è¡Œé¢å‘è§„åˆ™æŸ¥è¯¢çš„å¯¹è±¡æ¥æ£€ç´¢å¯¹è±¡ã€‚å¯ä»¥åˆ©ç”¨è¯¥ç±»æ¥å®Œæˆésqlè¯­å¥çš„æ•°æ®è¿‡æ»¤æŸ¥è¯¢ã€‚</p><h2 id=å¼•å…¥hibernate>å¼•å…¥Hibernate</h2><h3 id=æ‰‹åŠ¨å¼•å…¥>æ‰‹åŠ¨å¼•å…¥</h3><p>åœ¨Hibernateå®˜ç½‘<a class=link href=http://hibernate.org/orm/releases/ target=_blank rel=noopener>http://hibernate.org/orm/releases/</a>ä¸‹è½½åˆé€‚ç‰ˆæœ¬çš„èµ„æ–™ï¼Œå…¶ä¸­åŒ…æ‹¬hibernateçš„æºç ã€ç¼–è¯‘å¥½çš„jaråŒ…å’Œæ–‡æ¡£ä¿¡æ¯ã€‚</p><p>å¯¹äºæ™®é€šä½¿ç”¨åªéœ€è¦æŠŠ<code>lib\required</code>ç›®å½•ä¸‹çš„jaråŒ…å¼•å…¥é¡¹ç›®ï¼Œå¯¹äºç¼“å­˜çš„ä½¿ç”¨ï¼Œéœ€è¦å¼•å…¥<code>lib\optional\ehcache</code>ç›®å½•ä¸‹çš„<code>EHCache</code>çš„jaråŒ…ã€‚</p><h3 id=maven>maven</h3><p>hibernateåŒ…</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.hibernate<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>hibernate-core<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>5.4.21.Final<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¼“å­˜Ehcache</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.hibernate<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>hibernate-ehcache<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>5.4.21.Final<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Hibernate6ç›®å‰è¿˜å¤„äºæµ‹è¯•ç‰ˆã€‚</p><p><strong>ä½¿ç”¨ä¹‹å‰è¿˜éœ€è¦å¼•å…¥å¯¹åº”è‡ªå·±DataBaseçš„JDBCé©±åŠ¨ã€‚</strong></p><h2 id=hibernatecfgxmlé…ç½®æ–‡ä»¶>hibernate.cfg.xmlé…ç½®æ–‡ä»¶</h2><p><code>hibernate.cfg.xml</code>æ˜¯hibernateé…ç½®æ–‡ä»¶çš„é»˜è®¤æ–‡ä»¶åï¼Œåªéœ€è¦å°†hibernate.cfg.xmlæ–‡ä»¶æ”¾åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼Œhibernateå°†è‡ªåŠ¨è¯»å–æ–‡ä»¶ä¸­çš„é…ç½®ã€‚(<strong>å¯¹äºæ™®é€šçš„javaé¡¹ç›®ï¼Œhibernate.cfg.xmlåº”è¯¥æ”¾åœ¨srcç›®å½•ä¸‹</strong>)</p><p>é€šå¸¸éœ€è¦é…ç½®SQLæ–¹è¨€ã€è¿æ¥é©±åŠ¨ã€æ•°æ®åº“urlåœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ç­‰ã€‚å¯ä»¥ä½¿ç”¨<code>mapping</code>æ ‡ç­¾æ¥æŒ‡ç¤ºæ˜ å°„æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥åŒhibernateçš„é…ç½®æ–‡ä»¶æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE hibernate-configuration SYSTEM
</span></span></span><span class=line><span class=cl><span class=cp>        &#34;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;hibernate-configuration&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--    é…ç½®ä¸€ä¸ªsessionå·¥å‚--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;session-factory&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--        sqlæ–¹è¨€--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;hibernate.dialect&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            org.hibernate.dialect.MySQLDialect
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!--        jdbcé©±åŠ¨--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;hibernate.connection.driver_class&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            com.mysql.cj.jdbc.Driver
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=c>&lt;!--        æ•°æ®åº“é“¾æ¥--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;hibernate.connection.url&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            jdbc:mysql://localhost:3306/hibernate_study?serverTimezone=UTC
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!--        ç”¨æˆ·å--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;hibernate.connection.username&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            dev
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!--        å¯†ç --&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;hibernate.connection.password&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            123456
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!--        æ˜ å°„æ–‡ä»¶--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- æ”¯æŒpackageã€classã€fileã€jar --&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;mapping</span> <span class=na>resource=</span><span class=s>&#34;User.hbm.xml&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/session-factory&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/hibernate-configuration&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å‡ ä¸ªé‡è¦çš„é…ç½®å±æ€§>å‡ ä¸ªé‡è¦çš„é…ç½®å±æ€§</h3><div class=table-wrapper><table><thead><tr><th style=text-align:left>NO</th><th style=text-align:left><strong>å±æ€§å’Œæè¿°</strong></th></tr></thead><tbody><tr><td style=text-align:left>1</td><td style=text-align:left><strong>hibernate.connection.datasource</strong><br>åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨ç¯å¢ƒä¸­æ‚¨æ­£åœ¨ä½¿ç”¨çš„åº”ç”¨ç¨‹åº JNDI åã€‚</td></tr><tr><td style=text-align:left>2</td><td style=text-align:left><strong>hibernate.jndi.class</strong><br>JNDI çš„ InitialContext ç±»ã€‚</td></tr><tr><td style=text-align:left>3</td><td style=text-align:left><strong>hibernate.jndi.<jndipropertyname></strong><br>åœ¨ JNDIçš„ InitialContext ç±»ä¸­é€šè¿‡ä»»ä½•ä½ æƒ³è¦çš„ Java å‘½åå’Œç›®å½•æ¥å£å±æ€§ã€‚</td></tr><tr><td style=text-align:left>4</td><td style=text-align:left><strong>hibernate.jndi.url</strong><br>ä¸º JNDI æä¾› URLã€‚</td></tr><tr><td style=text-align:left>5</td><td style=text-align:left><strong>hibernate.connection.username</strong><br>æ•°æ®åº“ç”¨æˆ·åã€‚</td></tr><tr><td style=text-align:left>6</td><td style=text-align:left><strong>hibernate.connection.password</strong><br>æ•°æ®åº“å¯†ç ã€‚</td></tr></tbody></table></div><h3 id=æ•°æ®åº“æ–¹è¨€>æ•°æ®åº“æ–¹è¨€</h3><div class=table-wrapper><table><thead><tr><th style=text-align:left><strong>æ•°æ®åº“</strong></th><th style=text-align:left><strong>æ–¹è¨€å±æ€§</strong></th></tr></thead><tbody><tr><td style=text-align:left>DB2</td><td style=text-align:left>org.hibernate.dialect.DB2Dialect</td></tr><tr><td style=text-align:left>HSQLDB</td><td style=text-align:left>org.hibernate.dialect.HSQLDialect</td></tr><tr><td style=text-align:left>HypersonicSQL</td><td style=text-align:left>org.hibernate.dialect.HSQLDialect</td></tr><tr><td style=text-align:left>Informix</td><td style=text-align:left>org.hibernate.dialect.InformixDialect</td></tr><tr><td style=text-align:left>Ingres</td><td style=text-align:left>org.hibernate.dialect.IngresDialect</td></tr><tr><td style=text-align:left>Interbase</td><td style=text-align:left>org.hibernate.dialect.InterbaseDialect</td></tr><tr><td style=text-align:left>Microsoft SQL Server 2000</td><td style=text-align:left>org.hibernate.dialect.SQLServerDialect</td></tr><tr><td style=text-align:left>Microsoft SQL Server 2005</td><td style=text-align:left>org.hibernate.dialect.SQLServer2005Dialect</td></tr><tr><td style=text-align:left>Microsoft SQL Server 2008</td><td style=text-align:left>org.hibernate.dialect.SQLServer2008Dialect</td></tr><tr><td style=text-align:left>MySQL</td><td style=text-align:left>org.hibernate.dialect.MySQLDialect</td></tr><tr><td style=text-align:left>Oracle (any version)</td><td style=text-align:left>org.hibernate.dialect.OracleDialect</td></tr><tr><td style=text-align:left>Oracle 11g</td><td style=text-align:left>org.hibernate.dialect.Oracle10gDialect</td></tr><tr><td style=text-align:left>Oracle 10g</td><td style=text-align:left>org.hibernate.dialect.Oracle10gDialect</td></tr><tr><td style=text-align:left>Oracle 9i</td><td style=text-align:left>org.hibernate.dialect.Oracle9iDialect</td></tr><tr><td style=text-align:left>PostgreSQL</td><td style=text-align:left>org.hibernate.dialect.PostgreSQLDialect</td></tr><tr><td style=text-align:left>Progress</td><td style=text-align:left>org.hibernate.dialect.ProgressDialect</td></tr><tr><td style=text-align:left>SAP DB</td><td style=text-align:left>org.hibernate.dialect.SAPDBDialect</td></tr><tr><td style=text-align:left>Sybase</td><td style=text-align:left>org.hibernate.dialect.SybaseDialect</td></tr><tr><td style=text-align:left>Sybase Anywhere</td><td style=text-align:left>org.hibernate.dialect.SybaseAnywhereDialec</td></tr></tbody></table></div><h2 id=ç®€å•çš„xmlæ˜ å°„æ–‡ä»¶>ç®€å•çš„XMLæ˜ å°„æ–‡ä»¶</h2><p>æ‰€æœ‰çš„Entityåº”è¯¥æ˜¯æŒ‰ç…§java beançš„è¦æ±‚ç¼–å†™çš„POJOå¯¹è±¡ï¼Œä»¥User Entityä¸ºä¾‹ã€‚</p><p>User Entity:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nn>cn.llzero.entity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.io.Serializable</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>pass</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Character</span><span class=w> </span><span class=n>sex</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=nf>getId</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=nf>setId</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>this</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getName</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=nf>setName</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>this</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getPass</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>pass</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=nf>setPass</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>pass</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>pass</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pass</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>this</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Character</span><span class=w> </span><span class=nf>getSex</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>sex</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=nf>setSex</span><span class=p>(</span><span class=n>Character</span><span class=w> </span><span class=n>sex</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>sex</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sex</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>this</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>toString</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;User{&#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=s>&#34;id=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=s>&#34;, name=&#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=sc>&#39;\&#39;&#39;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=s>&#34;, pass=&#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>pass</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=sc>&#39;\&#39;&#39;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=s>&#34;, sex=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=sc>&#39;}&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>XMLæ˜ å°„æ–‡ä»¶ï¼ˆUser.hbm.xmlï¼‰:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE hibernate-mapping PUBLIC
</span></span></span><span class=line><span class=cl><span class=cp>        &#34;-//Hibernate/Hibernate Mapping DTD//EN&#34;
</span></span></span><span class=line><span class=cl><span class=cp>        &#34;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;hibernate-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&#34;cn.llzero.entity.User&#34;</span> <span class=na>table=</span><span class=s>&#34;user&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;meta</span> <span class=na>attribute=</span><span class=s>&#34;description&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            Useræ˜ å°„ï¼Œå­¦ä¹ Hibernate
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/meta&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;id</span> <span class=na>name=</span><span class=s>&#34;id&#34;</span> <span class=na>column=</span><span class=s>&#34;id&#34;</span> <span class=na>type=</span><span class=s>&#34;integer&#34;</span> <span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;generator</span> <span class=na>class=</span><span class=s>&#34;native&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/id&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>column=</span><span class=s>&#34;name&#34;</span> <span class=na>unique=</span><span class=s>&#34;true&#34;</span> <span class=na>type=</span><span class=s>&#34;string&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;pass&#34;</span> <span class=na>column=</span><span class=s>&#34;pass&#34;</span> <span class=na>type=</span><span class=s>&#34;string&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;sex&#34;</span> <span class=na>column=</span><span class=s>&#34;sex&#34;</span> <span class=na>type=</span><span class=s>&#34;char&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/hibernate-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>name => å¯¹åº”å®ä½“çš„å±æ€§ï¼Œ column => æ•°æ®åº“å­—æ®µï¼Œ typeæŒ‡ç¤ºäº†æ•°æ®çš„ç±»å‹ï¼Œè¯¥å±æ€§å»ºè®®ä½¿ç”¨hibernateçš„é¢„è®¾å€¼ã€‚</p><h3 id=hibernate-typeé¢„è®¾å€¼>hibernate typeé¢„è®¾å€¼</h3><p>å½“ä½ å‡†å¤‡ä¸€ä¸ª Hibernate æ˜ å°„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°ä½ æŠŠ Java æ•°æ®ç±»å‹æ˜ å°„åˆ°äº† RDBMS æ•°æ®æ ¼å¼ã€‚åœ¨æ˜ å°„æ–‡ä»¶ä¸­å·²ç»å£°æ˜è¢«ä½¿ç”¨çš„ <strong>types</strong> ä¸æ˜¯ Java æ•°æ®ç±»å‹ï¼›å®ƒä»¬ä¹Ÿä¸æ˜¯ SQL æ•°æ®åº“ç±»å‹ã€‚è¿™ç§ç±»å‹è¢«ç§°ä¸º Hibernate æ˜ å°„ç±»å‹ï¼Œå¯ä»¥ä» Java ç¿»è¯‘æˆ SQLï¼Œåä¹‹äº¦ç„¶ã€‚</p><p>åœ¨è¿™ä¸€ç« ä¸­åˆ—ä¸¾å‡ºæ‰€æœ‰çš„åŸºç¡€ï¼Œæ—¥æœŸå’Œæ—¶é—´ï¼Œå¤§å‹æ•°æ®å¯¹è±¡ï¼Œå’Œå…¶å®ƒå†…åµŒçš„æ˜ å°„æ•°æ®ç±»å‹ã€‚</p><h4 id=åŸå§‹ç±»å‹>åŸå§‹ç±»å‹</h4><div class=table-wrapper><table><thead><tr><th style=text-align:left>æ˜ å°„ç±»å‹</th><th style=text-align:left>Java ç±»å‹</th><th style=text-align:left>ANSI SQL ç±»å‹</th></tr></thead><tbody><tr><td style=text-align:left>integer</td><td style=text-align:left>int æˆ– java.lang.Integer</td><td style=text-align:left>INTEGER</td></tr><tr><td style=text-align:left>long</td><td style=text-align:left>long æˆ– java.lang.Long</td><td style=text-align:left>BIGINT</td></tr><tr><td style=text-align:left>short</td><td style=text-align:left>short æˆ– java.lang.Short</td><td style=text-align:left>SMALLINT</td></tr><tr><td style=text-align:left>float</td><td style=text-align:left>float æˆ– java.lang.Float</td><td style=text-align:left>FLOAT</td></tr><tr><td style=text-align:left>double</td><td style=text-align:left>double æˆ– java.lang.Double</td><td style=text-align:left>DOUBLE</td></tr><tr><td style=text-align:left>big_decimal</td><td style=text-align:left>java.math.BigDecimal</td><td style=text-align:left>NUMERIC</td></tr><tr><td style=text-align:left>character</td><td style=text-align:left>java.lang.String</td><td style=text-align:left>CHAR(1)</td></tr><tr><td style=text-align:left>string</td><td style=text-align:left>java.lang.String</td><td style=text-align:left>VARCHAR</td></tr><tr><td style=text-align:left>byte</td><td style=text-align:left>byte æˆ– java.lang.Byte</td><td style=text-align:left>TINYINT</td></tr><tr><td style=text-align:left>boolean</td><td style=text-align:left>boolean æˆ– java.lang.Boolean</td><td style=text-align:left>BIT</td></tr><tr><td style=text-align:left>yes/no</td><td style=text-align:left>boolean æˆ– java.lang.Boolean</td><td style=text-align:left>CHAR(1) (&lsquo;Y&rsquo; or &lsquo;N&rsquo;)</td></tr><tr><td style=text-align:left>true/false</td><td style=text-align:left>boolean æˆ– java.lang.Boolean</td><td style=text-align:left>CHAR(1) (&lsquo;T&rsquo; or &lsquo;F&rsquo;)</td></tr></tbody></table></div><h4 id=æ—¥æœŸå’Œæ—¶é—´ç±»å‹>æ—¥æœŸå’Œæ—¶é—´ç±»å‹</h4><div class=table-wrapper><table><thead><tr><th style=text-align:left>æ˜ å°„ç±»å‹</th><th style=text-align:left>Java ç±»å‹</th><th style=text-align:left>ANSI SQL ç±»å‹</th></tr></thead><tbody><tr><td style=text-align:left>date</td><td style=text-align:left>java.util.Date æˆ– java.sql.Date</td><td style=text-align:left>DATE</td></tr><tr><td style=text-align:left>time</td><td style=text-align:left>java.util.Date æˆ– java.sql.Time</td><td style=text-align:left>TIME</td></tr><tr><td style=text-align:left>timestamp</td><td style=text-align:left>java.util.Date æˆ– java.sql.Timestamp</td><td style=text-align:left>TIMESTAMP</td></tr><tr><td style=text-align:left>calendar</td><td style=text-align:left>java.util.Calendar</td><td style=text-align:left>TIMESTAMP</td></tr><tr><td style=text-align:left>calendar_date</td><td style=text-align:left>java.util.Calendar</td><td style=text-align:left>DATE</td></tr></tbody></table></div><h4 id=äºŒè¿›åˆ¶å’Œå¤§å‹æ•°æ®ç±»å‹>äºŒè¿›åˆ¶å’Œå¤§å‹æ•°æ®ç±»å‹</h4><div class=table-wrapper><table><thead><tr><th style=text-align:left>æ˜ å°„ç±»å‹</th><th style=text-align:left>Java ç±»å‹</th><th style=text-align:left>ANSI SQL ç±»å‹</th></tr></thead><tbody><tr><td style=text-align:left>binary</td><td style=text-align:left>byte[]</td><td style=text-align:left>VARBINARY (or BLOB)</td></tr><tr><td style=text-align:left>text</td><td style=text-align:left>java.lang.String</td><td style=text-align:left>CLOB</td></tr><tr><td style=text-align:left>serializable</td><td style=text-align:left>any Java class that implements java.io.Serializable</td><td style=text-align:left>VARBINARY (or BLOB)</td></tr><tr><td style=text-align:left>clob</td><td style=text-align:left>java.sql.Clob</td><td style=text-align:left>CLOB</td></tr><tr><td style=text-align:left>blob</td><td style=text-align:left>java.sql.Blob</td><td style=text-align:left>BLOB</td></tr></tbody></table></div><h4 id=jdkç›¸å…³ç±»å‹>JDKç›¸å…³ç±»å‹</h4><div class=table-wrapper><table><thead><tr><th style=text-align:left>æ˜ å°„ç±»å‹</th><th style=text-align:left>Java ç±»å‹</th><th style=text-align:left>ANSI SQL ç±»å‹</th></tr></thead><tbody><tr><td style=text-align:left>class</td><td style=text-align:left>java.lang.Class</td><td style=text-align:left>VARCHAR</td></tr><tr><td style=text-align:left>locale</td><td style=text-align:left>java.util.Locale</td><td style=text-align:left>VARCHAR</td></tr><tr><td style=text-align:left>timezone</td><td style=text-align:left>java.util.TimeZone</td><td style=text-align:left>VARCHAR</td></tr><tr><td style=text-align:left>currency</td><td style=text-align:left>java.util.Currency</td><td style=text-align:left>VARCHAR</td></tr></tbody></table></div><p>å¯¹åº”çš„sqlï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>user</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w>   </span><span class=kt>int</span><span class=w> </span><span class=kp>auto_increment</span><span class=w> </span><span class=k>primary</span><span class=w> </span><span class=k>key</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=kt>varchar</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>      </span><span class=k>not</span><span class=w> </span><span class=no>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pass</span><span class=w> </span><span class=kt>varchar</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span><span class=w>      </span><span class=k>not</span><span class=w> </span><span class=no>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sex</span><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=s1>&#39;M&#39;</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=no>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>constraint</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>unique</span><span class=w> </span><span class=p>(</span><span class=n>name</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=kp>charset</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>utf8</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=æ˜ å°„æ³¨è§£>æ˜ å°„æ³¨è§£</h2><p>ä½¿ç”¨hibernateçš„æ³¨è§£æ¯”ä½¿ç”¨xmlæ˜ å°„æ–‡ä»¶çš„æ–¹å¼æ–¹ä¾¿ï¼Œè€Œä¸”å…·æœ‰è‰¯å¥½çš„å¯è§‚æ€§ã€‚ç‰¹åˆ«æ˜¯åœ¨springæ¨å´‡çš„å»æ–‡æ¡£åŒ–ï¼Œå°½é‡å‡å°‘å¯¹xmlè¿™ç±»æ–‡æ¡£çš„ä¾èµ–ï¼Œé‡‡ç”¨ç¼–ç¨‹çš„æ–¹å¼è§£å†³é…ç½®ç­‰é—®é¢˜ã€‚</p><h4 id=entity>@Entity</h4><p><code>@Entity</code>ç”¨äºå¯¹POJOå®ä½“ç±»æ³¨è§£ï¼Œä»¥æ˜ç¡®è¿™æ˜¯ä¸€ä¸ªå®ä½“ç±»ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=table>@Table</h4><p><code>@Table</code>ç”¨äºæ³¨è§£å®ä½“å¯¹åº”çš„è¡¨ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=id>@Id</h4><p><code>@Id</code>ç”¨äºå¯¹<code>primark key</code>ä¸»é”®å±æ€§çš„æ³¨è§£ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=generatedvalue>@GeneratedValue</h4><p><code>@GeneratedValue</code>æ³¨è§£æŒ‡ç¤ºäº†å±æ€§å€¼çš„ç”Ÿæˆç­–ç•¥ï¼Œé€šå¸¸é€‰ç”¨<code>GenerationType.AUTO</code>å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>GenerationType</span><span class=p>.</span><span class=na>AUTO</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>GenerationType.AUTO : è‡ªåŠ¨é€‰æ‹©</p><p>GenerationType.SEQUENCE : æŒ‰é¡ºåºè‡ªå¢</p><p>GenerationType.Table : æŒ‰å€¼è¡¨çš„æ–¹å¼ï¼Œç”±hibernateç”Ÿæˆä¸€ä¸ªä¸»é”®è¡¨</p><p>GenerationType.IDENTITY : ä¿æŒä¸entityä¸€è‡´</p><h4 id=column>@Column</h4><p><code>@Column</code>æ³¨è§£ç”¨äºæ˜ å°„å®ä½“çš„<strong>å±æ€§</strong>å’Œè¡¨çš„<strong>å­—æ®µ</strong>çš„å…³ç³»ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w> </span><span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>GenerationType</span><span class=p>.</span><span class=na>AUTO</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;name&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>unique</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=dynamicupdateå’Œdynamicinsert>@DynamicUpdateå’Œ@DynamicInsert</h4><p>æŒ‡ç¤ºåœ¨å¯¹è±¡çš„æ›´æ–°ä¸æ’å…¥æ—¶ï¼Œè¿‡æ»¤nullå€¼çš„å±æ€§ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicInsert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=å®ä½“å…³ç³»è¡¨é—´å…³ç³»>å®ä½“å…³ç³»ï¼ˆè¡¨é—´å…³ç³»ï¼‰</h4><p>å¯¹äº<strong>å…³ç³»æ¨¡å¼</strong>çš„è¡¨é—´å…³ç³»æœ‰ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šçš„å…³ç³»ï¼Œå¯ä»¥é€šè¿‡æ³¨è§£çš„æ–¹å¼æ¥å®Œæˆå®ä½“é—´çš„å…³ç³»ã€‚</p><p>æ³¨æ„ï¼šåœ¨å®Œæˆå¯¹è±¡å…³ç³»æ—¶ï¼Œæœ‰å…³ç³»â€œæä¾›æ–¹â€å’Œâ€œä½¿ç”¨æ–¹â€ã€‚å…³ç³»çš„æä¾›æ–¹è¦ç»´æŠ¤ä¸¤è€…å…³ç³»ï¼Œè´Ÿè´£å¯¹æ•°æ®çš„æ“ä½œã€‚</p><p>å¯¹äºä¸€å¯¹ä¸€å’Œå¤šå¯¹å¤šï¼Œç»´æŠ¤æ–¹æŒ‰ç…§å®é™…å¯¹è±¡å…³ç³»ç¡®å®šå³å¯ï¼Œå¯¹äºä¸€å¯¹å¤šçš„æ–¹å¼ï¼Œç»´æŠ¤æ–¹åªèƒ½ä¸º<strong>ä¸€çš„é‚£ä¸ªå¯¹è±¡</strong>ã€‚</p><h5 id=onetoone-ä¸€å¯¹ä¸€>@OneToOne (ä¸€å¯¹ä¸€)</h5><p>ç°åœ¨æœ‰Userå’ŒRoleä¸¤ä¸ªç±»ï¼Œå‡è®¾ä¸€ä¸ªç”¨æˆ·åªèƒ½æœ‰ä¸€ä¸ªè§’è‰²ï¼Œä¸€ä¸ªè§’è‰²åªèƒ½å±äºä¸€ä¸ªç”¨æˆ·ã€‚</p><p>å¯¹äºUserç±»ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicInsert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToOne</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;role_id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>referencedColumnName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Role</span><span class=w> </span><span class=n>role</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å¯¹äºRoleç±»ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;role&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicInsert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Role</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToOne</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;role&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=n>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=onetomany-ä¸€å¯¹å¤š>@OneToMany (ä¸€å¯¹å¤š)</h5><p>å‡è®¾ä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªè§’è‰²ï¼Œä¸€ä¸ªè§’è‰²åªèƒ½å±äºä¸€ä¸ªç”¨æˆ·ã€‚</p><p>å¯¹äºUserç±»ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicInsert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@OneToMany</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Set</span><span class=o>&lt;</span><span class=n>Role</span><span class=o>&gt;</span><span class=w> </span><span class=n>roles</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å¯¹äºRoleç±»ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;role&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicInsert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Role</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToOne</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user_id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>referencedColumnName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=n>user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=manytomany-å¤šå¯¹å¤š>@ManyToMany (å¤šå¯¹å¤š)</h5><p>å‡è®¾ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªè§’è‰² ï¼Œä¸€ä¸ªè§’è‰²å¯ä»¥å±äºå¤šä¸ªç”¨æˆ·ã€‚ï¼ˆ<strong>æ³¨æ„ï¼šå¤šå¯¹å¤šçš„æƒ…å†µéœ€è¦å‡†å¤‡ä¸­é—´è¡¨ã€‚</strong>ï¼‰</p><p>æ ¹æ®å®é™…åˆ†æï¼Œç”±Useræ¥ä½œå…³ç³»çš„ç»´æŠ¤è€…ã€‚</p><p>å¯¹äºUserç±»:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicInsert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// @JoinColumnså®šä¹‰äº†ä¸­é—´è¡¨çš„ä¿¡æ¯</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToMany</span><span class=p>(</span><span class=n>targetEntity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Role</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@JoinTable</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user_role&#34;</span><span class=p>,</span><span class=w> </span><span class=n>joinColumns</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user_id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>referencedColumnName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>,</span><span class=w> </span><span class=n>inverseJoinColumns</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;role_id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>referencedColumnName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Set</span><span class=o>&lt;</span><span class=n>Role</span><span class=o>&gt;</span><span class=w> </span><span class=n>roles</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å¯¹äºRoleç±»:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;role&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicInsert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@DynamicUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Role</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ManyToMany</span><span class=p>(</span><span class=n>mappedBy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;roles&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Set</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashSet</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=åˆ›å»ºä¼šè¯session>åˆ›å»ºä¼šè¯ï¼ˆSessionï¼‰</h2><p>åˆ›å»ºä¼šè¯é¦–å…ˆéœ€è¦SessionFactoryï¼Œå¯ä»¥é€šè¿‡<code>Configuration</code>è¯»å–hibernateçš„é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…é€šè¿‡setPropertyçš„æ–¹å¼è®¾å®šhibernateçš„å±æ€§ã€‚</p><h3 id=sessionfactory>SessionFactory</h3><ol><li><p>è¯»å–é¡¹ç›®ç›®å½•ä¸‹çš„é»˜è®¤é…ç½®æ–‡ä»¶(hibernate.cfg.xml)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ä»¥ä¸‹è¯­å¥å°†ä½¿ç”¨é»˜è®¤çš„hibernate.cfg.xmlé…ç½®æ–‡ä»¶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>SessionFactory</span><span class=w> </span><span class=n>FACOTRY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Configuration</span><span class=p>().</span><span class=na>configure</span><span class=p>().</span><span class=na>buildSessionFactory</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>æŒ‡å®šé…ç½®æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦åœ¨invoke configureæ–¹æ³•æ—¶ä¼ å…¥é…ç½®æ–‡ä»¶ä¿¡æ¯</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// configureæ–¹æ³•åŸå‹å¦‚ä¸‹ï¼š</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>configure</span><span class=p>();</span><span class=w>		</span><span class=c1>// è¯»å–hibernate.cfg.xml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ä»¥ä¸‹è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>configure</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>resource</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>configure</span><span class=p>(</span><span class=n>URL</span><span class=w> </span><span class=n>url</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>configure</span><span class=p>(</span><span class=n>File</span><span class=w> </span><span class=n>configFile</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>é€šè¿‡ç¼–ç¨‹æ–¹å¼è®¾å®š
setPropertyæ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>new</span><span class=w> </span><span class=n>Configuration</span><span class=p>().</span><span class=na>configure</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.dialect&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.hibernate.dialect.MySQLDialect&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.connection.driver_class&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.connection.url&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;jdbc:mysql://localhost:3306/hibernate_study?serverTimezone=UTC&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.connection.username&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;dev&#34;</span><span class=p>).</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.connection.password&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;123456&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>buildSessionFactory</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>setPropertiesæ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// å®ä¾‹åŒ–Propertieså¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Properties</span><span class=w> </span><span class=n>prs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>prs</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;hibernate.dialect&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.hibernate.dialect.MysqlDialect&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>prs</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;hibernate.connection.driver_class&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// è®¾ç½®é…ç½®</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>new</span><span class=w> </span><span class=n>Configuration</span><span class=p>().</span><span class=na>configure</span><span class=p>().</span><span class=na>setProperties</span><span class=p>(</span><span class=n>prs</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=æ‰“å¼€ä¼šè¯>æ‰“å¼€ä¼šè¯</h3><p>å½“è·å¾—SeesionFactoryåï¼Œå°±å¯ä»¥é€šè¿‡factoryæ¥å¼€å¯Sessionä¼šè¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// å¼€æˆ·ä¸€ä¸ªä¼šè¯</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Session</span><span class=w> </span><span class=n>session</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FACTORY</span><span class=p>.</span><span class=na>openSession</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>coding</span><span class=p>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ä½¿ç”¨å®Œæˆåå…³é—­ä¼šè¯</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>session</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ä¹Ÿå¯ä»¥é€šè¿‡factoryå…³é—­æ‰€æœ‰å·²æ‰“å¼€çš„ä¼šè¯ï¼Œè¿™æ˜¯ä¸å®‰å…¨çš„</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//FACTORY.close();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=hql-hibernate-query-language>HQL (hibernate query language)</h2><p><code>HQL</code>çš„è¯­æ³•å’Œ<code>T-SQL</code>çš„è¯­æ³•å¤§è‡´ç›¸åŒï¼Œä¸è¿‡HQLæ˜¯å¯¹å¯¹è±¡è¿›è¡Œæ“ä½œï¼ˆå¯¹è±¡å·²ç»å’Œç›¸åº”çš„è¡¨è¿›è¡Œæ˜ å°„ ï¼‰ï¼Œè€ŒT-SQLç›´æ¥é’ˆå¯¹çš„æ˜¯è¡¨ã€‚ä½¿ç”¨HQLçš„<code>INSERT</code>è¯­å¥æ—¶éœ€è¦æ³¨æ„ï¼ŒINSERTè¯­å¥ä¸å…è®¸ç›´æ¥æ’å…¥æ–°çš„å¯¹è±¡æ•°æ®ï¼Œä½†æ˜¯å¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡çš„ä¿¡æ¯æ’å…¥å¦ä¸€ä¸ªå¯¹è±¡ï¼ˆä¸<code>SELECT</code>è¯­å¥ç»“åˆä½¿ç”¨ï¼‰ã€‚</p><h3 id=selectè¯­å¥>SELECTè¯­å¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// å¦‚æœè¦æŸ¥è¯¢æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œå¯ä»¥çœç•¥SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ³¨æ„è¿™é‡Œçš„Useræ˜¯å®ä½“ï¼Œè€Œä¸æ˜¯è¡¨å</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;FROM User&#34;</span><span class=p>;</span><span class=w>		</span><span class=c1>// ç­‰æ•ˆäº &#34;SELECT * FROM User&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// åˆ›å»ºæŸ¥è¯¢</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>);</span><span class=w>		</span><span class=c1>// =&gt; è¿”å›Queryå¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¯ä»¥å°†User.classä¼ å…¥</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>,</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>	</span><span class=c1>// =&gt; è¿”å›Query&lt;User&gt;å¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æœ€åå¯ä»¥é€šè¿‡list()æ–¹æ³•æ¥è·å–ç»“æœé›†</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>,</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>).</span><span class=na>list</span><span class=p>();</span><span class=w>		</span><span class=c1>// getResultsList()è°ƒç”¨çš„æ˜¯list()æ–¹æ³•</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// åªéœ€è¦è·å–ä¸€ä¸ªç»“æœï¼Œå¯ä»¥ä½¿ç”¨getSingleResult()æ–¹æ³•ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªUserå¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>,</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>).</span><span class=na>getSingleResult</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æŸ¥è¯¢å•ä¸ªå±æ€§æˆ–è€…å¤šä¸ªå±æ€§æ—¶ï¼Œå¿…è¦çš„æ—¶å€™éœ€è¦å°†ç»“æœå­˜å…¥mapä¸­ï¼Œæ–¹ä¾¿å¯¹æ•°æ®è¿›è¡Œè¯»å–ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// åªæŸ¥è¯¢idå±æ€§</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT id FROM User&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// è·å–ç»“æœé›†</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>List</span><span class=w> </span><span class=n>list</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>query</span><span class=p>.</span><span class=na>list</span><span class=p>();</span><span class=w>		</span><span class=c1>// è¿”å›çš„æ˜¯å«æœ‰å±æ€§å€¼çš„åˆ—è¡¨</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¯ä»¥è½¬æ¢ä¸ºmap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>List</span><span class=w> </span><span class=n>list1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>query</span><span class=p>.</span><span class=na>setResultTransformer</span><span class=p>(</span><span class=n>Criteria</span><span class=p>.</span><span class=na>ALIAS_TO_ENTITY_MAP</span><span class=p>).</span><span class=na>list</span><span class=p>();</span><span class=w>  </span><span class=c1>// è¿”å›å«æœ‰mapçš„liståˆ—è¡¨</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¯¹äºå¤šä¸ªå±æ€§çš„æŸ¥è¯¢ï¼Œä»¥ä¸Šçš„è½¬æ¢æ˜¯éå¸¸å¿…è¦çš„ï¼Œå¦åˆ™åªèƒ½å¾—åˆ°Objectå¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ³¨æ„ï¼šhibernateçš„å¾ˆå¤šæ–¹æ³•å·²ç»å¼ƒç”¨ï¼ŒåŒ…æ‹¬setResultTransformeræ–¹æ³•ã€‚</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å®é™…ä¸Šå¯¹äºç®€å•çš„CRUDï¼Œå¯ä»¥é€šè¿‡hibernateå°è£…çš„findã€saveã€saveOrUpdateã€deleteæ–¹æ³•æ¥æ“ä½œå®ä½“ã€‚</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT id, name FROM User&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>query1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>List</span><span class=w> </span><span class=n>list2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>query1</span><span class=p>.</span><span class=na>setResultTransformer</span><span class=p>(</span><span class=n>Criteria</span><span class=p>.</span><span class=na>ALIAS_TO_ENTITY_MAP</span><span class=p>).</span><span class=na>list</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=åŠ¨æ€å‚æ•°>åŠ¨æ€å‚æ•°</h3><p>æ›¾å‡ ä½•æ—¶ï¼Œä½¿ç”¨jdbcçš„æ—¶å€™ï¼Œä½¿ç”¨"?&ldquo;ä½œä¸ºå ä½ç¬¦ã€‚ç°åœ¨ä½¿ç”¨hibernateç»‘å®šå‚æ•°å˜å¾—æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥ä½¿ç”¨&rdquo;:<parameter-name>&ldquo;çš„æ–¹å¼ï¼Œæˆ–è€…ä½¿ç”¨jpaçš„å ä½æ ¼å¼ï¼Œ&rdquo;?<parameter-index>"ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ç»‘å®šå‚æ•°</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;UPDATE User Set name = :name, pass = :pass WHERE id = :id&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¯¹äºéæŸ¥è¯¢æ“ä½œï¼Œè®°å¾—å¼€å¯äº‹åŠ¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Transaction</span><span class=w> </span><span class=n>tx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sexxion</span><span class=p>.</span><span class=na>beginTransaction</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>,</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>query</span><span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&#34;name&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;newName&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>query</span><span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&#34;pass&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;newPass&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>query</span><span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>query</span><span class=p>.</span><span class=na>executeUpdate</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æäº¤å½“å‰äº‹åŠ¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>tx</span><span class=p>.</span><span class=na>commit</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ä½¿ç”¨jpaçš„å ä½ç¬¦æ ¼å¼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// jpaçš„æ ¼å¼çš„é—®å·åŠ ä¸Šå‚æ•°ç´¢å¼•çš„æ–¹å¼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å³ &#34;?&lt;parameter-index&gt;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ³¨æ„ï¼šç´¢å¼•ä¸‹æ ‡æ˜¯ä»0å¼€å§‹çš„</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;FROM User WHERE id = ?0&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>,</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>query</span><span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=n>0</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>		</span><span class=c1>// fistr param is index</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>query</span><span class=p>.</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=deleteè¯­å¥>DELETEè¯­å¥</h3><p>åœ¨å®é™…çš„æµ‹è¯•ä¸­ï¼Œå¯¹äºéæŸ¥è¯¢çš„è¯­å¥éœ€è¦å¼€å¯äº‹åŠ¡ï¼Œå¦åˆ™å°†ä¼šå‡ºç°å¼‚å¸¸ã€‚å…¶æ¬¡ä¸æŸ¥è¯¢ä¸åŒçš„æ˜¯éœ€è¦è°ƒç”¨<code>executeUpdate()</code>æ–¹æ³•æ¥æ‰§è¡ŒéæŸ¥è¯¢æ“ä½œã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;DELETE FROM User WHERE id = 1&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¼€å¯äº‹åŠ¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Transaction</span><span class=w> </span><span class=n>tx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>beginTransaction</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// æ‰§è¡Œdelete</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>).</span><span class=na>executeUpdate</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// æäº¤äº‹åŠ¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tx</span><span class=p>.</span><span class=na>commit</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>HibernateException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tx</span><span class=p>.</span><span class=na>rollback</span><span class=p>();</span><span class=w> </span><span class=c1>// å›æ»š</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// å…³é—­session</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>session</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=updateè¯­å¥>UPDATEè¯­å¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;UPDATE User SET name = &#39;llzero&#39;, pass = &#39;123456&#39; WHERE id = 1&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¼€å¯äº‹åŠ¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Transaction</span><span class=w> </span><span class=n>tx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>beginTransaction</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>).</span><span class=na>executeUpdate</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// æäº¤äº‹åŠ¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tx</span><span class=p>.</span><span class=na>commit</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>HibernateException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tx</span><span class=p>.</span><span class=na>rollback</span><span class=p>();</span><span class=w> </span><span class=c1>// å›æ»š</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// å…³é—­session</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>session</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=insertè¯­å¥>INSERTè¯­å¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// æ³¨æ„ï¼šINSERTä¸èƒ½ç”¨äºç›´æ¥æ’å…¥å¯¹è±¡ï¼Œåªæœ‰ç”¨äºå¤åˆ¶å¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ä¸åƒT-SQLä¸€æ ·ï¼Œæœ‰VALUESå…³é”®å­—</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¤åˆ¶idä¸º1çš„å¯¹è±¡çš„passå’Œsexå±æ€§ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªnameä¸º&#39;llZero&#39;çš„æ–°å¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;INSERT INTO User(name, pass, sex) SELECT &#39;llZero&#39;, pass, sex FROM User WHERE id = 1&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=where-å­å¥>WHERE å­å¥</h3><p><code>WHEREå­å¥</code>èƒ½å¤Ÿå¯¹æŸ¥è¯¢çš„æ•°æ®è¿›è¡Œfilterï¼Œæ”¯æŒä½¿ç”¨<code>AND</code>å’Œ<code>OR</code>å…³é”®å­—æ¥ç»„åˆé€»è¾‘ï¼Œå…¶ä¸­è¡¨è¾¾å¼ç¬¦å·æœ‰"="ã€"!="ã€">"ã€">="ã€"&lt;"ã€"&lt;=&ldquo;ä»¥åŠ&rdquo;()&ldquo;ç­‰ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;FROM User WHERE id = 1 OR id = 3 OR id &gt;= 10&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=aså…³é”®å­—>ASå…³é”®å­—</h3><p>ASå¯ä»¥ä¸ºè¡¨æˆ–è€…æŸä¸€å±æ€§å–åˆ«åã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT U.id AS uid, U.name AS uname FROM User AS U&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=order-by-æ’åº>ORDER BY æ’åº</h3><p>å¯¹äºæ’åºï¼ŒåŒT-SQLä¸€æ ·ï¼Œä½¿ç”¨<code>ORDER BY</code>å…³é”®å­—ï¼Œå¤šä¸ªå‚ä¸æ’åºçš„å±æ€§ä½¿ç”¨â€œ,â€éš”å¼€ã€‚</p><p>DESC : é™åº</p><p>ASC (é»˜è®¤): å‡åº</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;FROM User ORDER BY name, id DESC&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=group-by-åˆ†ç»„>GROUP BY åˆ†ç»„</h3><p>hqlçš„åˆ†ç»„åŒT-SQLä¸€è‡´ï¼Œå¤šä¸ªå‚ä¸åˆ†ç»„çš„å±æ€§é‡‡ç”¨åŠè§’é€—å·éš”å¼€ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;FROM User GROUP BY name, pass&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=åˆ†é¡µæŸ¥è¯¢>åˆ†é¡µæŸ¥è¯¢</h3><p>hibernateçš„åˆ†é¡µæŸ¥è¯¢é€šè¿‡è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•æ¥å®ç°ï¼Œå…¶æ•ˆæœå’Œ<code>LIMIT</code>å…³é”®å­—ç›¸åŒã€‚</p><p>setFirstResult(int resultPoint) : å¼€å§‹è¯»å–çš„ä½ç½®</p><p>setMaxResults(int num) : æ¯æ¬¡æœ€å¤§å¤šå°‘æ¡æ•°æ®</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;FROM User&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ä»¥ä¸‹è¯­å¥ä»ç¬¬å››ä¸ªå¯¹è±¡å¼€å§‹è¯»å–ï¼Œæœ€å¤šè¿”å›5ä¸ªå¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>hql</span><span class=p>,</span><span class=w> </span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>).</span><span class=na>setFirstResult</span><span class=p>(</span><span class=n>3</span><span class=p>).</span><span class=na>setMaxRusults</span><span class=p>(</span><span class=n>5</span><span class=p>).</span><span class=na>list</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=èšåˆå‡½æ•°>èšåˆå‡½æ•°</h3><div class=table-wrapper><table><thead><tr><th style=text-align:left>S.N.</th><th style=text-align:left>æ–¹æ³•</th><th style=text-align:left>æè¿°</th></tr></thead><tbody><tr><td style=text-align:left>1</td><td style=text-align:left>avg(property name)</td><td style=text-align:left>å±æ€§çš„å¹³å‡å€¼</td></tr><tr><td style=text-align:left>2</td><td style=text-align:left>count(property name or *)</td><td style=text-align:left>å±æ€§åœ¨ç»“æœä¸­å‡ºç°çš„æ¬¡æ•°</td></tr><tr><td style=text-align:left>3</td><td style=text-align:left>max(property name)</td><td style=text-align:left>å±æ€§å€¼çš„æœ€å¤§å€¼</td></tr><tr><td style=text-align:left>4</td><td style=text-align:left>min(property name)</td><td style=text-align:left>å±æ€§å€¼çš„æœ€å°å€¼</td></tr><tr><td style=text-align:left>5</td><td style=text-align:left>sum(property name)</td><td style=text-align:left>å±æ€§å€¼çš„æ€»å’Œ</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ä½¿ç”¨countçš„ä¾‹å­</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>hql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT count(pass) AS pCount FROM User Group By pass&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=æ ‡å‡†æŸ¥è¯¢>æ ‡å‡†æŸ¥è¯¢</h2><p>hibernateçš„æ ‡æŸ¥è¯¢ä½¿ç”¨åˆ°çš„Classæ˜¯<code>Criteria</code>ï¼Œå…¶å®è´¨æ˜¯å°†hqlè¿›è¡Œ<strong>åˆ†æ‹†</strong>å†<strong>ç»„åˆ</strong>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Criteria</span><span class=w> </span><span class=n>cr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createCriteria</span><span class=p>(</span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¯¹æ ‡å‡†çš„é™åˆ¶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ä½¿ç”¨addæ–¹æ³•æ¥æ·»åŠ å¯¹æ ‡å‡†çš„é™åˆ¶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Restrictionsä¸­å®šä¹‰ç›¸å…³é™åˆ¶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>eq</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>3</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>isNull</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>isNotNull</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>isNotEmpty</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>ge</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>10</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>le</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>20</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>gt</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>30</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>lt</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>40</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ¨¡ç³ŠæŸ¥è¯¢ï¼Œä½¿ç”¨&#34;%&#34;æˆ–&#34;_&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>like</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;5%&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å€¼åŒºé—´</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>between</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>2</span><span class=p>,</span><span class=w> </span><span class=n>5</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ANDæˆ–ORæ¡ä»¶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Criterion</span><span class=w> </span><span class=n>cr1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Restrictions</span><span class=p>.</span><span class=na>eq</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Criterion</span><span class=w> </span><span class=n>cr2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Restrictions</span><span class=p>.</span><span class=na>eq</span><span class=p>(</span><span class=s>&#34;pass&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;123456&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>and</span><span class=p>(</span><span class=n>cr1</span><span class=p>,</span><span class=w> </span><span class=n>cr2</span><span class=p>)).</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>Restrictions</span><span class=p>.</span><span class=na>or</span><span class=p>(</span><span class=n>cr1</span><span class=p>,</span><span class=w> </span><span class=n>cr2</span><span class=p>)).</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// åˆ†é¡µ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>setFirstResult</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>setMaxResults</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ’åºï¼Œä½¿ç”¨Orderç±»</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ³¨æ„addOrderæ–¹æ³•</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>addOrder</span><span class=p>(</span><span class=n>Order</span><span class=p>.</span><span class=na>desc</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>)).</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// é¢„æµ‹ä¸èšåˆ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Projectionsç±»ä¸­çš„æ–¹æ³•æœ‰æ±‚æœ€å€¼ã€å¹³å‡å€¼ç­‰çš„æ–¹æ³•</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>setProjection</span><span class=p>(</span><span class=n>Projections</span><span class=p>.</span><span class=na>avg</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>cr</span><span class=p>.</span><span class=na>setProjection</span><span class=p>(</span><span class=n>Projections</span><span class=p>.</span><span class=na>max</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>)).</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=åŸç”ŸæŸ¥è¯¢>åŸç”ŸæŸ¥è¯¢</h2><p>hibernateé™¤äº†æ”¯æŒHQLä¸æ ‡å‡†æŸ¥è¯¢ä»¥å¤–ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨åŸç”Ÿçš„SQLè¯­å¥è¿›è¡ŒæŸ¥è¯¢ã€‚ä½†æ˜¯å¹¶ä¸å»ºè®®é‚£ä¹ˆåšï¼Œå› ä¸ºä¸åŒçš„DBMSçš„è¯­æ³•å­˜åœ¨å‡ºå…¥ï¼Œå¯èƒ½ä¼šä¸ºç§»æ¤å¸¦æ¥ä¸ä¾¿ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span><span class=w> </span><span class=n>sql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM user&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>NativeQuery</span><span class=w> </span><span class=n>sqlQuery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createSQLQuery</span><span class=p>(</span><span class=n>sql</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ ‡é‡æŸ¥è¯¢</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>sql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT id,name FROM user&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>NativeQuery</span><span class=w> </span><span class=n>sqlQuery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createSQLQuery</span><span class=p>(</span><span class=n>sql</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æŠŠç»“æœè½¬æ¢ä¸ºmapå¯¹è±¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>setResultTransformer</span><span class=p>(</span><span class=n>Criteria</span><span class=p>.</span><span class=na>ALIAS_TO_ENTITY_MAP</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>query</span><span class=p>.</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å®ä½“æŸ¥è¯¢</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// é€šè¿‡SqlQueryçš„addEntity(O)æ–¹æ³•æ·»åŠ å®ä½“æ˜ å°„æ•°æ®</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>sql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM user&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>SQLQuery</span><span class=w> </span><span class=n>sqlQuery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createSQLQuery</span><span class=p>(</span><span class=n>sql</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// ç»‘å®šçš„å®ä½“</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>addEntity</span><span class=p>(</span><span class=s>&#34;cn.llzero.entity.User&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>addEntity</span><span class=p>(</span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>list</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// åŠ¨æ€å‚æ•°</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// å¯ä»¥å‚è€ƒHQL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>sql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM user WHERE id = :id&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>SQLQuery</span><span class=w> </span><span class=n>sqlQuery</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>session</span><span class=p>.</span><span class=na>createSQLQuery</span><span class=p>(</span><span class=n>sql</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>addEntity</span><span class=p>(</span><span class=s>&#34;cn.llzero.entity.User&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&#34;id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>sqlQuery</span><span class=p>.</span><span class=na>getSingleResult</span><span class=p>());</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=interceptor-æ‹¦æˆªå™¨>interceptor æ‹¦æˆªå™¨</h2><p>å®ç°hibernateçš„æ‹¦æˆªå™¨æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯å®ç°Interceptoræ¥å£ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯ç»§æ‰¿EmptyInterceptorç©ºæ‹¦æˆªå™¨é€‰æ‹©æ€§çš„é‡å†™è‡ªå·±æƒ³è¦å®ç°çš„æ–¹æ³•ã€‚</p><p>Interceptorçš„å®šä¹‰å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>Interceptor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onLoad</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>var3</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>var4</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>var5</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onFlushDirty</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>var3</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>var4</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>var5</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>var6</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onSave</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>var3</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>var4</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>var5</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>onDelete</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>var3</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>var4</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>var5</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>onCollectionRecreate</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>onCollectionRemove</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>onCollectionUpdate</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>preFlush</span><span class=p>(</span><span class=n>Iterator</span><span class=w> </span><span class=n>var1</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>postFlush</span><span class=p>(</span><span class=n>Iterator</span><span class=w> </span><span class=n>var1</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Boolean</span><span class=w> </span><span class=nf>isTransient</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=nf>findDirty</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>var3</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>var4</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>var5</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>var6</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Object</span><span class=w> </span><span class=nf>instantiate</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>EntityMode</span><span class=w> </span><span class=n>var2</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var3</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=nf>getEntityName</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>var1</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Object</span><span class=w> </span><span class=nf>getEntity</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>var1</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>var2</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>afterTransactionBegin</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>var1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>beforeTransactionCompletion</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>var1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>afterTransactionCompletion</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>var1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=cm>/** @deprecated */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Deprecated</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=nf>onPrepareStatement</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>var1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>ç¼–å†™<code>HibernateInterceptor</code>ç±»ï¼Œå¹¶ç»§æ‰¿<code>EmptyInterceptor</code>é‡å†™æ–¹æ³•ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>HibernateInterceptor</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>EmptyInterceptor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onDelete</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>types</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;on delete!&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onDelete</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>types</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onFlushDirty</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>currentState</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>previousState</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>types</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;on flush dirty&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>onFlushDirty</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>currentState</span><span class=p>,</span><span class=w> </span><span class=n>previousState</span><span class=p>,</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>types</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onLoad</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>types</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;on load&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>onLoad</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>types</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>onSave</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>types</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;on save&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>onSave</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>,</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>types</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>postFlush</span><span class=p>(</span><span class=n>Iterator</span><span class=w> </span><span class=n>entities</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;post flush&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>postFlush</span><span class=p>(</span><span class=n>entities</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>preFlush</span><span class=p>(</span><span class=n>Iterator</span><span class=w> </span><span class=n>entities</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;pre flush&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>preFlush</span><span class=p>(</span><span class=n>entities</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Boolean</span><span class=w> </span><span class=nf>isTransient</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>entity</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;isTransient&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>isTransient</span><span class=p>(</span><span class=n>entity</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>instantiate</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>entityName</span><span class=p>,</span><span class=w> </span><span class=n>EntityMode</span><span class=w> </span><span class=n>entityMode</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;instantiate&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>instantiate</span><span class=p>(</span><span class=n>entityName</span><span class=p>,</span><span class=w> </span><span class=n>entityMode</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=nf>findDirty</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>currentState</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>[]</span><span class=w> </span><span class=n>previousState</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>Type</span><span class=o>[]</span><span class=w> </span><span class=n>types</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;findDirty&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>findDirty</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>currentState</span><span class=p>,</span><span class=w> </span><span class=n>previousState</span><span class=p>,</span><span class=w> </span><span class=n>propertyNames</span><span class=p>,</span><span class=w> </span><span class=n>types</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getEntityName</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>object</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;getEntityName&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>getEntityName</span><span class=p>(</span><span class=n>object</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>getEntity</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>entityName</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;getEntity&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>getEntity</span><span class=p>(</span><span class=n>entityName</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>afterTransactionBegin</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>tx</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;afterTransactionBegin&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>afterTransactionBegin</span><span class=p>(</span><span class=n>tx</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>afterTransactionCompletion</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>tx</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;afterTransactionCompletion&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>afterTransactionCompletion</span><span class=p>(</span><span class=n>tx</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>beforeTransactionCompletion</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>tx</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;beforeTransactionCompletion&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>beforeTransactionCompletion</span><span class=p>(</span><span class=n>tx</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>onPrepareStatement</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>sql</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;onPrepareStatement&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>onPrepareStatement</span><span class=p>(</span><span class=n>sql</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCollectionRemove</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>collection</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>key</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;onCollectionRemove&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCollectionRemove</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCollectionRecreate</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>collection</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>key</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;onCollectionRecreate&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCollectionRecreate</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCollectionUpdate</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>collection</span><span class=p>,</span><span class=w> </span><span class=n>Serializable</span><span class=w> </span><span class=n>key</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CallbackException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;onCollectionUpdate&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCollectionUpdate</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=æ‹¦æˆªå™¨å¸¸ç”¨æ–¹æ³•è§£é‡Š>æ‹¦æˆªå™¨å¸¸ç”¨æ–¹æ³•è§£é‡Š</h3><blockquote><p>findDirty()
è¿™ä¸ªæ–¹æ³•åœ¨å½“ flush() æ–¹æ³•åœ¨ä¸€ä¸ª Session å¯¹è±¡ä¸Šè¢«è°ƒç”¨æ—¶è¢«è°ƒç”¨ã€‚
instantiate()
è¿™ä¸ªæ–¹æ³•åœ¨ä¸€ä¸ªæŒç»­çš„ç±»è¢«å®ä¾‹åŒ–æ—¶è¢«è°ƒç”¨ã€‚
isUnsaved()
è¿™ä¸ªæ–¹æ³•åœ¨å½“ä¸€ä¸ªå¯¹è±¡è¢«ä¼ åˆ° saveOrUpdate() æ–¹æ³•æ—¶è¢«è°ƒç”¨ã€‚
onDelete()
è¿™ä¸ªæ–¹æ³•åœ¨ä¸€ä¸ªå¯¹è±¡è¢«åˆ é™¤å‰è¢«è°ƒç”¨ã€‚
onFlushDirty()
è¿™ä¸ªæ–¹æ³•åœ¨å½“ Hibernate æ¢æµ‹åˆ°ä¸€ä¸ªå¯¹è±¡åœ¨ä¸€æ¬¡ flushï¼ˆä¾‹å¦‚ï¼Œæ›´æ–°æ“ä½œï¼‰ä¸­æ˜¯è„çš„ï¼ˆä¾‹å¦‚ï¼Œè¢«ä¿®æ”¹ï¼‰æ—¶è¢«è°ƒç”¨ã€‚
onLoad()
è¿™ä¸ªæ–¹æ³•åœ¨ä¸€ä¸ªå¯¹è±¡è¢«åˆå§‹åŒ–ä¹‹å‰è¢«è°ƒç”¨ã€‚
onSave()
è¿™ä¸ªæ–¹æ³•åœ¨ä¸€ä¸ªå¯¹è±¡è¢«ä¿å­˜å‰è¢«è°ƒç”¨ã€‚
postFlush()
è¿™ä¸ªæ–¹æ³•åœ¨ä¸€æ¬¡ flush å·²ç»å‘ç”Ÿå¹¶ä¸”ä¸€ä¸ªå¯¹è±¡å·²ç»åœ¨å†…å­˜ä¸­è¢«æ›´æ–°åè¢«è°ƒç”¨ã€‚
preFlush()
è¿™ä¸ªæ–¹æ³•åœ¨ä¸€æ¬¡ flush å‰è¢«è°ƒç”¨ã€‚</p></blockquote><h3 id=ä½¿ç”¨è‡ªå®šä¹‰æ‹¦æˆªå™¨>ä½¿ç”¨è‡ªå®šä¹‰æ‹¦æˆªå™¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// å¯¹äºæ‰€æœ‰çš„ä¼šè¯</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// é€šè¿‡setInterceptoræ–¹æ³•æŒ‡å®šæ‹¦æˆªå™¨</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>SessionFactory</span><span class=w> </span><span class=n>FACTORY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Configuration</span><span class=p>().</span><span class=na>configure</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>setInterceptor</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>HibernateInterceptor</span><span class=p>()).</span><span class=na>addAnnotatedClass</span><span class=p>(</span><span class=n>User</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>buildSessionFactory</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=hibernateç¼“å­˜>hibernateç¼“å­˜</h2><p>ä½¿ç”¨ <code>session.flush()</code> å’Œ <code>session.clear()</code> å¯ä»¥åŒæ­¥ç¼“å­˜å’Œæ¸…ç†å†…å­˜ä¸­çš„ç¼“å­˜ï¼Œhibernateé»˜è®¤ä½¿ç”¨çš„CacheProvideræ˜¯EHCacheã€‚</p></section><footer class=article-footer><section class=article-tags><a href=/tags/spring/>Spring</a>
<a href=/tags/hibernate/>Hibernate</a>
<a href=/tags/spring-data-jpa/>Spring-Data-Jpa</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/framework/spring/spring-context-util/><div class=article-details><h2 class=article-title>Springå¯åŠ¨æ—¶ï¼Œå°†SpringContextè®¾ç½®åˆ°Utilä¸­ï¼ˆSpringContextUtilï¼‰</h2></div></a></article><article><a href=/post/framework/spring/spring-security-using-browser-cache/><div class=article-details><h2 class=article-title>ä½¿ç”¨Spring-Securityåï¼Œæµè§ˆå™¨ä¸èƒ½ç¼“å­˜çš„é—®é¢˜</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2021 -
2024 BY CPoet</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=/libs/photo-swipe/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=/libs/photo-swipe/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=/libs/photo-swipe/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=/libs/photo-swipe/photoswipe.min.css crossorigin=anonymous></main></div><script src=/libs/vibrant/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>